<html>
<head>
    <meta charset="utf-8">
    <!--<script src="http://cdn.clappr.io/latest/clappr.min.js"></script>-->
    <script src="../clappr-1142-20161018.js"></script>
</head>
<body>
<div id="player1"></div>
<script>
    class mediaControlSeekDisable extends Clappr.MediaControl {
        constructor(options) {
            super(options);
        }

        getSettings() {
            let newSettings = $.extend({}, this.container.settings);
            newSettings.seekEnabled = false;
            return newSettings;
        }
    }

    var mainPlayer = new Clappr.Player({
        source: 'http://d11.cdnvideo.ru/videojs/files/h264-high-aac.mp4',
        autoPlay: false,
        height: 400,
        width: 700,
        hideMediaControl: false,
        mediacontrol: {seekbar: "#ff43a4", buttons: "#ff43a4"},
        parentId: "#player1",
    });

    var d = document.createElement('div');
    d.style.width = 700;
    d.style.height = 400;
    d.style.position = 'relative';
    //    d.style.backgroundColor = 'green';
    d.style.zIndex = 99000;
    d.style.top = -400;
    d.id = 'player2';

    var z = document.getElementById('player1');
    z.style.height = 400;
    document.getElementById('player1').appendChild(d);

    var adPlayer = new Clappr.Player({
        source: 'https://d11.cdnvideo.ru/videojs/files/echpochmak.mp4',
//        autoPlay: true,
        autoPlay: true,
        height: 400,
        width: 700,
        hideMediaControl: false,
        mediacontrol: {external: mediaControlSeekDisable},
        parentId: "#player2",
        events: {
            onEnded: function () {
                console.log('onEnded called');
                var self = this;
//                console.log(self);
                //                self.core.containers[0].settings.seekEnabled = false;
                self.destroy();
                d.parentElement.removeChild(d);
                mainPlayer.play();
            },
        }
    });

//    adPlayer.seek(9);

    //    function wait(ms){
    //        var start = new Date().getTime();
    //        var end = start;
    //        while(end < start + ms) {
    //            end = new Date().getTime();
    //        }
    //    }
    //
    //    console.log('wait');
    //    wait(3000);
    //    player.core.containers[0].settings.seekEnabled = false;

    //    player.attachTo(playerElement);
    //    console.log(player.core.getCurrentPlayback().name);

    //        events: {
    //            onReady: function () {
    //                console.log('r');
    //                var self = this;
    //                console.log(self);
    ////                self.core.containers[0].settings.seekEnabled = false;
    ////                self.play();
    //            }
    //        }
</script>
</body>
</html>
